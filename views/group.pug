extends layout

block scripts
  script(src='/javascripts/events.js')
  script let groupid = #{groupid};
  script.
    function sendEvent(eventId, eventName, eventDescription) {
      let form = document.createElement('form');
      form.method = 'POST';
      form.action = '/users/event';
      form.style.display = 'none';

      let eventid = document.createElement('input');
      eventid.name = 'eventid';
      eventid.value = eventId;

      let eventname = document.createElement('input');
      eventname.name = 'eventname';
      eventname.value = eventName;

      let eventdescription = document.createElement('input');
      eventdescription.name = 'eventdescription';
      eventdescription.value = eventDescription;

      form.appendChild(eventid);
      form.appendChild(eventname);
      form.appendChild(eventdescription);
      document.body.appendChild(form);
      form.submit();
    }

    window.onload = async () => {
      var events = await getEvents(groupid);
      console.log(events);
      if (events.length > 0) {
        var table = document.getElementById('events').getElementByTagName('tbody')[0];
        table.deleteRow(0);
        table.deleteRow(0);
        for (event of events) {
          var row = table.insertRow();
          var td = row.insertCell();
          var text = document.createtextNode(event.name);
          td.appendChild(text);
          td.setAttribute('onclick', 'sendEvent(' + event.id + ',"' + event.name + '","' + event.description + '")');
          var td = row.insertCell();
          var text = document.createtextNode(event.description);
          td.setAttribute('onclick', 'sendEvent(' + event.id + ',"' + event.name + '","' + event.description + '")');
        }
      }
    }

block content
  link(rel='stylesheet', href='/stylesheets/groups-override.css')
  h2= groupname
  table#events
    thead
      tr
        th meets
        th description
    tbody
      tr#default
        td no meets anytime soon!
        td 
      tr#default
        td miss each other yet?
        td